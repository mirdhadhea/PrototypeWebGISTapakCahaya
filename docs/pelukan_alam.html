<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GeoVillage+ - Pelukan Alam</title>

  <!-- CSS utama -->
  <link rel="stylesheet" href="static/css/styles.css" />

  <!-- Swiper & Leaflet CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin>
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css">

  <style>
    /* Jika perlu, pin jarak rute sederhana */
    .distance-badge-pin{
      padding:6px 10px;border-radius:999px;background:#0b67d0;color:#fff;
      font:600 12px/1.2 system-ui,Segoe UI,Roboto,Arial,sans-serif;
      box-shadow:0 2px 8px rgba(0,0,0,.25); transform:translate(-50%,-50%);
      white-space:nowrap
    }
    /* Pastikan peta terlihat jika belum diatur di CSS global */
    #leaflet-map{height:480px}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="container nav">
      <div class="brand">
        <span class="logo"><img src="static/img/busel.png" alt="Busel" /></span>
        <div class="brand-text"><strong>Kabupaten</strong><br>Buton<br>Selatan</div>
      </div>
      <nav class="menu">
        <a href="./index.html">Beranda</a>
        <a href="./warisan_abadi.html">Warisan Abadi</a>
        <a href="./pelukan_alam.html" class="active">Pelukan Alam</a>
        <a href="./tangan_berkarya.html">Tangan Berkarya</a>
        <a href="./statistik_desa.html">Statistik Desa</a>
        <a href="./sapa_kami.html" class="cta">Sapa Kami</a>
      </nav>
    </div>
  </header>

  <!-- ======== KONTEN: Pelukan Alam ======== -->
  <section class="pelukan-alam">
    <div class="swiper pelukan-slider">
      <div class="swiper-wrapper">
        <div class="swiper-slide">
          <img src="static/img/kacimbola.png" alt="Pantai Kacimbola">
          <div class="slide-caption">
            <h2>Pantai Kacimbola</h2>
            <p>Hamparan pasir putih berpadu dengan birunya Laut Flores, menciptakan panorama menawan yang menenangkan jiwa. Setiap pagi, cahaya matahari memantul di permukaan laut, menghadirkan kilau keemasan yang memukau.</p>
          </div>
        </div>
        <div class="swiper-slide">
          <img src="static/img/waburi.png" alt="Waburi Park">
          <div class="slide-caption">
            <h2>Waburi Park</h2>
            <p>Taman wisata ini berada di puncak tebing dengan panorama laut yang membentang luas. Dari ketinggian, pengunjung dapat menikmati pemandangan air biru jernih dan garis pantai berpasir putih yang memesona. Tempat yang tepat untuk menyaksikan indahnya matahari terbenam di ufuk barat.</p>
          </div>
        </div>
        <div class="swiper-slide">
          <img src="static/img/kunawe.png" alt="Ceruk Konawe">
          <div class="slide-caption">
            <h2>Ceruk Konawe</h2>
            <p>Di tebing kawasan Pantai Kunawe terdapat gua alami yang menyimpan peninggalan masa prasejarah. Pada dindingnya masih tampak goresan purba berupa cap tangan, pola garis, dan bentuk menyerupai daun, serta ditemukan sisa-sisa tulang manusia berukuran besar.</p>
          </div>
        </div>
      </div>
      <div class="swiper-button-prev"></div><div class="swiper-button-next"></div><div class="swiper-pagination"></div>
    </div>
  </section>

  <div class="intro-wisata">
    <p>Keindahan alam Gaya Baru tak hanya terpancar dari destinasi wisatanya, tetapi juga dari kekayaan laut, flora, dan faunanya. Setiap sudut wilayah ini menyimpan potensi alam yang menjadi sumber kehidupan dan kebanggaan masyarakatnya.</p>
  </div>

  <section class="stay-list" style="isolation:isolate">
    <div class="container" style="position:relative;z-index:1">
      <h2 class="stay-title">Kekayaan Laut</h2>
      <div class="alam-grid">
        <article class="alam-card">
          <img src="static/img/cakalang.png" alt="Ikan Cakalang" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Ikan Cakalang</h3>
            <p class="alam-sub">Permata laut dari perairan Buton Selatan ini dikenal dengan dagingnya yang padat dan gurih. Ikan cakalang hidup berkelompok di laut lepas dan menjadi hasil tangkapan utama nelayan Gaya Baru. Selain bernilai ekonomi tinggi, cakalang juga menjadi simbol ketekunan masyarakat pesisir dalam menjaga sumber daya laut.</p>
          </div>
        </article>
        <article class="alam-card">
          <img src="static/img/tuna.png" alt="Ikan Tuna" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Ikan Tuna</h3>
            <p class="alam-sub">Raja samudra dengan tubuh ramping dan kuat ini menandakan laut yang subur dan sehat. Perairan Gaya Baru menjadi jalur migrasi alami tuna yang mencari arus hangat Laut Flores. Potensi penangkapan lestari menjadikan spesies ini andalan dalam program perikanan berkelanjutan.</p>
          </div>
        </article>
        <article class="alam-card">
          <img src="static/img/tongkol.png" alt="Ikan Tongkol" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Ikan Tongkol</h3>
            <p class="alam-sub">Sahabat nelayan yang selalu hadir di setiap musim. Tongkol adalah spesies tangguh yang mudah beradaptasi, menjadikan laut Gaya Baru selalu hidup dan berdenyut. Selain sebagai komoditas pangan, tongkol mencerminkan keseimbangan antara kebutuhan manusia dan keberlanjutan alam.</p>
          </div>
        </article>
      </div>
    </div>
  </section>

  <section class="stay-list">
    <div class="container">
      <h2 class="stay-title">Kekayaan Flora</h2>
      <div class="alam-grid">
        <article class="alam-card">
          <img src="static/img/rotan.png" alt="Rotan Batang" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Rotan Batang</h3>
            <p class="alam-sub">Tumbuh merambat di hutan-hutan tropis Gaya Baru, rotan batang menjadi bahan penting dalam kerajinan tangan masyarakat. Teksturnya yang lentur namun kuat melambangkan harmoni antara alam dan budaya lokal. Keindahan rotan ini menjadi bagian dari potensi ekonomi hijau yang lestari.</p>
          </div>
        </article>
        <article class="alam-card">
          <img src="static/img/terumbu.png" alt="Terumbu Karang" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Terumbu Karang</h3>
            <p class="alam-sub">Di bawah laut Gaya Baru terbentang taman karang penuh warna, rumah bagi ribuan biota laut. Bentuknya yang beragam dan warnanya yang memesona menjadikan spot ini surga bagi penyelam dan peneliti kelautan. Terumbu karang bukan hanya keindahan, tetapi benteng alami yang melindungi pantai dari gelombang besar.</p>
          </div>
        </article>
        <article class="alam-card">
          <img src="static/img/anggrek.png" alt="Anggrek Serat" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Anggrek Serat</h3>
            <p class="alam-sub">Permata hutan dengan kelopak halus dan aroma lembut. Anggrek serat tumbuh alami di lereng lembab dan pepohonan tua, menjadikannya lambang keindahan dan keanggunan alam tropis. Warna bunganya yang eksotis menjadi daya tarik bagi peneliti dan pecinta botani.</p>
          </div>
        </article>
      </div>
    </div>
  </section>

  <section class="stay-list">
    <div class="container">
      <h2 class="stay-title">Kekayaan Fauna</h2>
      <div class="alam-grid">
        <article class="alam-card">
          <img src="static/img/kangkareng.png" alt="Kangkareng Sulawesi" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Kangkareng Sulawesi</h3>
            <p class="alam-sub">Dengan paruh besar dan suara nyaring yang menggema di hutan, Kangkareng menjadi simbol hutan yang masih hidup. Burung ini berperan penting dalam penyebaran biji, menjaga regenerasi pohon hutan tropis. Keindahan bulunya menjadikannya ikon alam liar Sulawesi.</p>
          </div>
        </article>
        <article class="alam-card">
          <img src="static/img/macaca.png" alt="Monyet Macaca" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Monyet Macaca</h3>
            <p class="alam-sub">Primata cerdas yang hidup berkelompok di hutan Gaya Baru. Gerakannya lincah dan ekspresinya menarik, mencerminkan dinamika kehidupan liar di hutan tropis. Keberadaannya menjadi indikator keseimbangan ekosistem yang masih terjaga.</p>
          </div>
        </article>
        <article class="alam-card">
          <img src="static/img/maleo.png" alt="Burung Maleo" class="alam-media">
          <div class="alam-body"><h3 class="alam-name">Burung Maleo</h3>
            <p class="alam-sub">Burung endemik Sulawesi yang langka dan dilindungi. Maleo bertelur di pasir panas pesisir, memanfaatkan panas bumi untuk menetaskan anaknya, bukti kecerdasan alami yang unik. Keberadaannya di sekitar Gaya Baru menambah nilai konservasi dan kebanggaan ekowisata lokal.</p>
          </div>
        </article>
      </div>
    </div>
  </section>

  <section class="map-section" id="peta">
    <div class="container">
      <h2 class="section-title">Peta Tempat Wisata</h2>
      <div class="map-frame"><div id="leaflet-map"></div></div>
    </div>
  </section>
  <!-- ============================================= -->

  <svg aria-hidden="true" viewBox="0 0 1440 120" preserveAspectRatio="none" style="display:block;width:100%;height:88px">
    <path d="M0,80 C200,40 400,120 600,80 C800,40 1000,120 1200,80 C1320,50 1440,100 1440,100 L1440,120 L0,120 Z" fill="#1e365a"></path>
  </svg>

  <footer class="site-footer">
    <div class="container footer-grid">
      <div>
        <div class="footer-brand">Desa<br>Gaya<br>Baru</div>
        <p>Kecamatan Lapandewa<br>Kabupaten Buton Selatan,<br>Sulawesi Tenggara 93753</p>
      </div>
      <div class="footer-contact">
        <h4>Hubungi Kami</h4>
        <ul class="contact-list">
          <li>
            <span class="ic" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M22 16.9v3a2 2 0 0 1-2.2 2 19.9 19.9 0 0 1-8.6-3.1 19.6 19.6 0 0 1-6-6 19.9 19.9 0 0 1-3.1-8.6A2 2 0 0 1 4.1 2h3a2 2 0 0 1 2 1.7c.1.8.3 1.6.6 2.4a2 2 0 0 1-.5 2.1L8.1 9.9a16 16 0 0 0 6 6l1.7-1.1a2 2 0 0 1 2.1-.5c.8.2 1.6.5 2.4.6A2 2 0 0 1 22 16.9Z" stroke="currentColor" stroke-width="2"/></svg></span>
            <a href="https://wa.me/6281323642950">0813-2364-2950</a>
          </li>
          <li>
            <span class="ic" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2"/><path d="M3 7.5 12 13 21 7.5" stroke="currentColor" stroke-width="2"/></svg></span>
            <a href="mailto:info@desagayabaru.id">info@desagayabaru.id</a>
          </li>
        </ul>
        <div class="socials">
          <a href="https://www.facebook.com/DesaGayaBaruKecLapandewaKabupatenButonSelatan/" target="_blank" rel="noopener" aria-label="Facebook" class="soc"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" stroke="currentColor" stroke-width="2"/></svg></a>
          <a href="https://www.youtube.com/@Waburi_Park/" target="_blank" rel="noopener" aria-label="YouTube" class="soc"><svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="2" y="6" width="20" height="12" rx="3" stroke="currentColor" stroke-width="2"/><path d="M10 9.5 15 12l-5 2.5z" fill="currentColor"/></svg></a>
        </div>
      </div>
      <div><p style="font-style:italic">“Di pesisir ini, ombak bercerita, angin berbisik, dan kehidupan berjalan dalam harmoni.”</p></div>
    </div>
    <div class="footer-credits"><small>© <span id="year"></span> Desa Gaya Baru — by Mirdha Dhea Permata</small></div>
  </footer>

  <!-- Lib JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin></script>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
  <script src="https://unpkg.com/shpjs@latest/dist/shp.min.js"></script>

  <script>
    // Tahun otomatis
    document.getElementById('year').textContent = new Date().getFullYear();

    // Swiper
    new Swiper(".pelukan-slider",{
      loop:true,speed:700,grabCursor:true,effect:"coverflow",centeredSlides:true,
      slidesPerView:"auto",spaceBetween:40,
      coverflowEffect:{rotate:0,stretch:0,depth:180,modifier:1.2,slideShadows:false},
      navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},
      pagination:{el:".swiper-pagination",clickable:true},
      autoplay:{delay:5000,disableOnInteraction:false},
      breakpoints:{320:{spaceBetween:16},640:{spaceBetween:24},1024:{spaceBetween:40}}
    });

    // Leaflet + Routing + shpjs
    document.addEventListener("DOMContentLoaded",async()=>{
      if(!window.L) return;

      const osm  = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}),
            topo = L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxZoom:17}),
            sat  = L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:19});

      const map = L.map("leaflet-map",{center:[-5.66,122.76],zoom:13,layers:[osm]});
      const layerControl = L.control.layers({OSM:osm,Topografi:topo,Satelit:sat},null,{position:"topright",collapsed:true}).addTo(map);

      const locations = [
        {name:"Waburi Park",      coords:[-5.663294086295358,122.76500923206746]},
        {name:"Pantai Kacimbola", coords:[-5.657579664077717,122.7610348916279]},
        {name:"Ceruk Konawe",     coords:[-5.669443346244777,122.76431883050331]}
      ];
      locations.forEach(l=>L.marker(l.coords).addTo(map).bindPopup(`<b>${l.name}</b>`));

      const byName = n=>locations.find(o=>o.name===n),
            fmtKm  = m=>`Jarak: ${(m/1000).toFixed(1)} km`;

      const midpointOnLine = latlngs=>{
        if(!latlngs||latlngs.length<2) return latlngs?.[0];
        let total=0, seg=[];
        for(let i=1;i<latlngs.length;i++){const d=latlngs[i-1].distanceTo(latlngs[i]); seg.push(d); total+=d}
        const half=total/2; let acc=0;
        for(let i=1;i<latlngs.length;i++){
          if(acc+seg[i-1]>=half){
            const t=(half-acc)/seg[i-1], a=latlngs[i-1], b=latlngs[i];
            return L.latLng(a.lat+t*(b.lat-a.lat), a.lng+t*(b.lng-a.lng));
          }
          acc+=seg[i-1];
        }
        return latlngs[Math.floor(latlngs.length/2)];
      };

      const norm = s=>String(s||"").toLowerCase().replace(/\s+/g," ").trim();
      const colorFor = leg=>{
        const c=norm(leg), exact={
          "permukiman":{stroke:"#000",fill:"#FFCCBF"},
          "belukar":{stroke:"#000",fill:"#A6FF78"},
          "tanah terbuka":{stroke:"#000",fill:"#ffffff"},
          "savana / padang rumput":{stroke:"#000",fill:"#66BF3B"},
          "kebun campuran":{stroke:"#000",fill:"#BDFFA1"},
          "hutan lahan kering":{stroke:"#000",fill:"#C7E0B0"},
          "hutan mangrove":{stroke:"#000",fill:"#A6FF78"},
          "tubuh air":{stroke:"#00FFFF",fill:"#CCFFFF"}
        };
        if(exact[c]) return exact[c];
        if(c.includes("permuk")) return {stroke:"#000",fill:"#FFCCBF"};
        if(c.includes("belukar")) return {stroke:"#000",fill:"#A6FF78"};
        if(c.includes("terbuka")) return {stroke:"#000",fill:"#ffffff"};
        if(c.includes("savana")||c.includes("padang")) return {stroke:"#000",fill:"#66BF3B"};
        if(c.includes("kebun")) return {stroke:"#000",fill:"#BDFFA1"};
        if(c.includes("mangrove")) return {stroke:"#000",fill:"#A6FF78"};
        if(c.includes("hutan")) return {stroke:"#000",fill:"#C7E0B0"};
        if(c.includes("air")||c.includes("sungai")||c.includes("danau")) return {stroke:"#00FFFF",fill:"#CCFFFF"};
        return {stroke:"#ff7b00",fill:"#ffd9ab"};
      };

      async function loadTutupanLahan(){
        const ab = await fetch("static/geo/tuplah.zip").then(r=>{ if(!r.ok) throw new Error("fetch gagal"); return r.arrayBuffer() });
        const gj = await shp(ab);
        const tutupan = L.geoJSON(gj,{
          style:f=>{ const c=colorFor(f.properties?.Legenda); return {color:c.stroke,weight:1.2,fillColor:c.fill,fillOpacity:.5} },
          onEachFeature:(f,l)=>{
            const p=f.properties||{}, leg=p.Legenda||p.name||"Tutupan Lahan", luas=p.Luas??p.luas??p.LUAS;
            const tip=(luas!=null&&String(luas).trim()!=="")?`${leg} — Luas: ${luas}`:leg;
            l.bindTooltip(tip,{sticky:true});
            l.bindPopup(`<div style="min-width:240px"><div><b>${leg}</b></div>${luas?`<div>Luas: <b>${luas}</b></div>`:""}</div>`);
          }
        }).addTo(map);
        layerControl.addOverlay(tutupan,"Tutupan Lahan");
        try{ map.fitBounds(tutupan.getBounds(),{padding:[18,18]}) }catch(e){}
        return tutupan;
      }

      function makeRouteOverlay(title,fromName,toName,color="#0b67d0"){
        const A=byName(fromName), B=byName(toName); if(!A||!B) return;
        const group=L.layerGroup();
        L.Routing.control({
          waypoints:[L.latLng(A.coords),L.latLng(B.coords)],
          router:L.Routing.osrmv1({serviceUrl:"https://router.project-osrm.org/route/v1"}),
          showAlternatives:false, fitSelectedRoutes:false, addWaypoints:false,
          draggableWaypoints:false, routeWhileDragging:false,
          createMarker:()=>null,
          lineOptions:{styles:[{color:"transparent",weight:0,opacity:0}]}
        })
        .on("routesfound",e=>{
          const r=e.routes[0];
          L.polyline(r.coordinates,{color,weight:5,opacity:.9}).addTo(group);
          const mid=midpointOnLine(r.coordinates), txt=fmtKm(r.summary.totalDistance);
          L.marker(mid,{icon:L.divIcon({className:"",html:`<div class="distance-badge-pin">${txt}</div>`,iconSize:null,iconAnchor:[0,0]}),interactive:false}).addTo(group);
        }).addTo(map);
        layerControl.addOverlay(group,title);
        group.addTo(map);
      }

      await loadTutupanLahan();
      makeRouteOverlay("Pantai Kacimbola ke Waburi Park","Pantai Kacimbola","Waburi Park","#0b67d0");
      makeRouteOverlay("Waburi Park ke Ceruk Konawe","Waburi Park","Ceruk Konawe","#0b67d0");

      L.control.scale({imperial:false}).addTo(map);
    });
  </script>
</body>
</html>
